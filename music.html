<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Glitchy Anime Lofi Music Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&family=Montserrat:wght@400;700&display=swap" rel="stylesheet"/>
  <style>
    /* Reset + base */
    * {
      box-sizing: border-box;
      scrollbar-width: thin;
      scrollbar-color: #00ffdb44 transparent;
    }
    *::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    *::-webkit-scrollbar-track {
      background: transparent;
    }
    *::-webkit-scrollbar-thumb {
      background-color: #00ffdbbb;
      border-radius: 10px;
      border: 2px solid transparent;
      background-clip: content-box;
    }

    body {
      margin: 0;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      font-family: 'Montserrat', sans-serif;
      color: #00ffdb;
      overflow-x: hidden;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position: relative;
    }

    /* Sakura petals floating animation */
    .petal {
      position: fixed;
      background: #ff9a9e;
      width: 12px;
      height: 12px;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      opacity: 0.8;
      filter: drop-shadow(0 0 3px #ff8c94);
      animation: fall linear infinite;
      pointer-events: none;
      z-index: 1000;
      transform-origin: center;
    }

    @keyframes fall {
      0% {
        transform: translateY(-20px) rotate(0deg);
        opacity: 0.9;
      }
      50% {
        opacity: 0.6;
      }
      100% {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* Create multiple petals with different positions and delays */
    .petal:nth-child(1) { left: 10%; animation-duration: 12s; animation-delay: 0s;}
    .petal:nth-child(2) { left: 20%; animation-duration: 15s; animation-delay: 3s;}
    .petal:nth-child(3) { left: 30%; animation-duration: 13s; animation-delay: 2s;}
    .petal:nth-child(4) { left: 40%; animation-duration: 17s; animation-delay: 5s;}
    .petal:nth-child(5) { left: 50%; animation-duration: 14s; animation-delay: 1s;}
    .petal:nth-child(6) { left: 60%; animation-duration: 16s; animation-delay: 4s;}
    .petal:nth-child(7) { left: 70%; animation-duration: 18s; animation-delay: 7s;}
    .petal:nth-child(8) { left: 80%; animation-duration: 15s; animation-delay: 0s;}
    .petal:nth-child(9) { left: 90%; animation-duration: 19s; animation-delay: 6s;}
    .petal:nth-child(10) { left: 95%; animation-duration: 20s; animation-delay: 9s;}

    /* Header */
    header {
      padding: 3rem 1rem 1rem;
      text-align: center;
      position: relative;
      z-index: 10;
      user-select: none;
    }

    header h1 {
      font-family: 'Major Mono Display', monospace;
      font-weight: 400;
      font-size: 3.5rem;
      letter-spacing: 0.15em;
      color: #00ffd7;
      text-shadow:
        0 0 10px #00ffd7,
        0 0 20px #00ffd7,
        0 0 30px #00ffd7,
        0 0 40px #00ffd7,
        0 0 70px #00ffd7;
      margin: 0;
    }

    /* Main content container */
    main {
      flex: 1;
      max-width: 700px;
      margin: 0 auto 4rem;
      padding: 1rem 2rem 3rem;
      background: rgba(15, 32, 39, 0.8);
      border-radius: 25px;
      box-shadow:
        0 0 15px #00ffda88,
        inset 0 0 15px #00ffda88;
      backdrop-filter: blur(10px);
      position: relative;
      z-index: 10;
    }

    /* Upload Section */
    .upload-section {
      margin-bottom: 2rem;
    }

    label {
      font-weight: 700;
      font-size: 1.25rem;
      color: #00ffe7;
      display: block;
      margin-bottom: 0.6rem;
      user-select: none;
      text-shadow: 0 0 4px #00ffe7aa;
    }

    input[type="file"] {
      width: 100%;
      padding: 0.6rem 1rem;
      border-radius: 15px;
      border: none;
      background: #112d38;
      color: #00ffdb;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      box-shadow:
        inset 0 0 6px #00ffdaaa;
      transition: background 0.3s ease;
      user-select: none;
    }

    input[type="file"]:hover {
      background: #00ffda11;
    }

    button.upload-btn {
      margin-top: 1rem;
      background: linear-gradient(45deg, #00fff7, #00ccbc);
      color: #042f2e;
      font-weight: 900;
      border: none;
      padding: 0.85rem 1.8rem;
      border-radius: 35px;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow:
        0 0 15px #00fff7,
        0 0 30px #00fff7;
      user-select: none;
      letter-spacing: 0.07em;
      text-transform: uppercase;
      transition: 
        background 0.4s ease,
        box-shadow 0.4s ease,
        transform 0.15s ease;
      position: relative;
      overflow: hidden;
    }
    button.upload-btn::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(60deg, transparent, #00fff7aa, transparent);
      animation: shimmer 3s infinite;
      z-index: 0;
      filter: blur(15px);
    }
    @keyframes shimmer {
      0% { transform: rotate(0deg) translateX(-100%); }
      100% { transform: rotate(360deg) translateX(100%); }
    }
    button.upload-btn:hover {
      background: linear-gradient(45deg, #00ccbc, #00fff7);
      box-shadow:
        0 0 25px #00fff7,
        0 0 40px #00fff7;
      transform: scale(1.07);
      z-index: 1;
    }

    /* Playlist */
    .playlist {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 260px;
      overflow-y: auto;
      border-radius: 15px;
      box-shadow: inset 0 0 12px #00ffdbaa;
      background: #042f2e;
      font-weight: 700;
      user-select: none;
    }

    .playlist li {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #00ffdb22;
      color: #00ffe7;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background 0.3s ease;
      text-shadow:
        0 0 5px #00ffe7cc,
        0 0 10px #00ffe7cc;
    }

    .playlist li:hover {
      background: #00ffe744;
      color: #004040;
      text-shadow: none;
      box-shadow: 0 0 15px #00ffdbcc inset;
      border-radius: 15px;
      font-weight: 900;
      letter-spacing: 0.02em;
    }

    /* Currently playing highlight */
    .playlist li.active {
      background: #00ffdbaa;
      color: #004040;
      font-weight: 900;
      box-shadow:
        0 0 25px #00fff7 inset,
        0 0 30px #00fff7;
      border-radius: 15px;
      pointer-events: none;
    }

    /* Audio Player */
    audio {
      width: 100%;
      margin-top: 2rem;
      border-radius: 20px;
      box-shadow:
        0 0 25px #00ffdbcc;
      background: #004040;
      outline: none;
      user-select: none;
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 1rem;
      font-size: 0.9rem;
      color: #00ffe7aa;
      user-select: none;
      letter-spacing: 0.05em;
      text-shadow: 0 0 3px #00ffe7bb;
      z-index: 10;
      position: relative;
    }

    /* Chill lofi radio widget container */
    .lofi-widget {
      margin-top: 2rem;
      border-radius: 25px;
      overflow: hidden;
      box-shadow:
        0 0 30px #00ffe7cc,
        inset 0 0 30px #00ffe7cc;
    }
    .lofi-widget iframe {
      width: 100%;
      height: 160px;
      border: none;
      user-select: none;
      pointer-events: auto;
      filter: drop-shadow(0 0 8px #00ffdbbb);
      border-radius: 25px;
    }

    /* Cool glitch text animation for playlist hover */
    @keyframes glitch {
      0% {
        text-shadow:
          1px 0 #00fff7,
          -1px 0 #00ffb3,
          0 1px #00ffc6,
          0 -1px #00ffa3;
      }
      20% {
        text-shadow:
          -1px 0 #00fff7,
          1px 0 #00ffb3,
          0 -1px #00ffc6,
          0 1px #00ffa3;
      }
      40% {
        text-shadow:
          1px 1px #00fff7,
          -1px -1px #00ffb3,
          1px -1px #00ffc6,
          -1px 1px #00ffa3;
      }
      60% {
        text-shadow:
          -1px 1px #00fff7,
          1px -1px #00ffb3,
          -1px -1px #00ffc6,
          1px 1px #00ffa3;
      }
      80% {
        text-shadow:
          1px -1px #00fff7,
          -1px 1px #00ffb3,
          1px 1px #00ffc6,
          -1px -1px #00ffa3;
      }
      100% {
        text-shadow:
          1px 0 #00fff7,
          -1px 0 #00ffb3,
          0 1px #00ffc6,
          0 -1px #00ffa3;
      }
    }

    .playlist li:hover {
      animation: glitch 1s infinite;
    }

  </style>
</head>
<body>
  <header>
    <h1>Glitchy Anime Lofi Hub</h1>
  </header>

  <!-- Floating petals -->
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>
  <div class="petal"></div>

  <main>
    <section class="upload-section">
      <label for="audio-upload">Upload your fav beats (mp3, wav)</label>
      <input type="file" id="audio-upload" accept="audio/*" />
      <button class="upload-btn" id="addTrackBtn">Add Track</button>
    </section>

    <ul class="playlist" id="playlist" tabindex="0" aria-label="Music playlist">
      <!-- dynamically added tracks will appear here -->
    </ul>

    <audio controls id="audioPlayer" aria-label="Audio player">
      Your browser does not support the audio element.
    </audio>

    <!-- Chill lofi radio embed -->
    <div class="lofi-widget" aria-label="Chill lofi radio">
      <iframe src="https://www.youtube.com/embed/5qap5aO4i9A?autoplay=0&mute=0&loop=1&playlist=5qap5aO4i9A" title="Lofi hip hop radio - beats to relax/study to" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
  </main>

  <footer>
    &copy; 2025 Glitchy Lofi Beats — Powered by Anime Vibes & Chill
  </footer>

  <script>
    const audioUpload = document.getElementById('audio-upload');
    const addTrackBtn = document.getElementById('addTrackBtn');
    const playlist = document.getElementById('playlist');
    const audioPlayer = document.getElementById('audioPlayer');

    // Store tracks as array of {name, url}
    const tracks = [];

    // Helper: sanitize text for display
    function sanitize(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Add track to playlist UI and array
    function addTrack(file) {
      if (!file) return;
      const url = URL.createObjectURL(file);
      const name = file.name;

      tracks.push({name, url});

      const li = document.createElement('li');
      li.textContent = name;
      li.tabIndex = 0;

      // Play track when clicked
      li.addEventListener('click', () => {
        playTrack(tracks.indexOf(tracks.find(t => t.name === name && t.url === url)));
      });
      // Keyboard accessible: Enter/Space to play
      li.addEventListener('keydown', e => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          li.click();
        }
      });

      playlist.appendChild(li);

      // Auto play if first track
      if (tracks.length === 1) {
        playTrack(0);
      }
    }

    // Highlight currently playing track
    function highlightTrack(index) {
      [...playlist.children].forEach((li, i) => {
        if(i === index) {
          li.classList.add('active');
        } else {
          li.classList.remove('active');
        }
      });
    }

    // Play track by index
    function playTrack(index) {
      if(index < 0 || index >= tracks.length) return;
      audioPlayer.src = tracks[index].url;
      audioPlayer.play();
      highlightTrack(index);
      currentTrackIndex = index;
    }

    // Upload button handler
    addTrackBtn.addEventListener('click', () => {
      if(audioUpload.files.length === 0) {
        alert('Please select a track first!');
        return;
      }
      addTrack(audioUpload.files[0]);
      audioUpload.value = ''; // reset input
    });

    // Track list navigation via keyboard arrows (up/down)
    playlist.addEventListener('keydown', e => {
      if(tracks.length === 0) return;
      let activeIndex = [...playlist.children].findIndex(li => li.classList.contains('active'));
      if(activeIndex === -1) activeIndex = 0;
      if(e.key === "ArrowDown") {
        e.preventDefault();
        let nextIndex = (activeIndex + 1) % tracks.length;
        playlist.children[nextIndex].focus();
      } else if(e.key === "ArrowUp") {
        e.preventDefault();
        let prevIndex = (activeIndex - 1 + tracks.length) % tracks.length;
        playlist.children[prevIndex].focus();
      }
    });

    // Auto play next track when one ends
    audioPlayer.addEventListener('ended', () => {
      let next = currentTrackIndex + 1;
      if(next >= tracks.length) next = 0;
      playTrack(next);
    });

    // Initialize currentTrackIndex
    let currentTrackIndex = -1;
  </script>
</body>
</html>
